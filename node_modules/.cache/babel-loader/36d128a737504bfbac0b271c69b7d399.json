{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\lukas\\\\Desktop\\\\Programowanko\\\\Projekty\\\\benzen\\\\src\\\\pages\\\\LoginPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useLayoutEffect, useEffect } from \"react\"; //react router\n\nimport { useLocation } from \"react-router\";\nimport { Link, useHistory } from \"react-router-dom\"; //api\n\nimport { loginUrl, registerUrl } from \"../api\"; //redux\n\nimport { useDispatch } from \"react-redux\";\nimport { loginAction } from \"../actions/loginAction\"; //styling\n\nimport styled from \"styled-components\"; //material ui\n\nimport TextField from \"@material-ui/core/TextField\";\nimport InputAdornment from \"@material-ui/core/InputAdornment\"; //icons\n\nimport VisibilityIcon from \"@material-ui/icons/Visibility\";\nimport SearchIcon from \"@material-ui/icons/Search\";\nimport FavoriteIcon from \"@material-ui/icons/Favorite\"; //history\n\nimport HistoryIcon from \"@material-ui/icons/History\";\nimport axios from \"axios\"; //encrypting password\n\nimport sha512 from \"crypto-js/sha512\";\nimport Base64 from \"crypto-js/enc-base64\";\n\nconst AccountPage = () => {\n  _s();\n\n  //state\n  const [size, setSize] = useState([0, 0]);\n  const [mv, setMV] = useState(false); //login state\n\n  const [loginPasswordView, setLoginPasswordView] = useState(true);\n  const [loginEmailInput, setLoginEmail] = useState(\"\");\n  const [loginPasswordInput, setLoginPassword] = useState(\"\");\n  const [falseLogin, setFalseLogin] = useState(false);\n  const [falseEmail, setFalseEmail] = useState(false);\n  const [loginErrorMsg, setLoginErrorMsg] = useState(false); //register state\n\n  const [registerPasswordView, setRegisterPasswordView] = useState(true);\n  const [registerPassword, setRegisterPassword] = useState(\"\");\n  const [registerEmailInput, setRegisterEmail] = useState(\"\");\n  const [registerName, setRegisterName] = useState(\"\");\n  const [registerSurname, setRegisterSurname] = useState(\"\");\n  const [registerError, setRegisterError] = useState(false);\n  const [registerErrorMsg, setRegisterErrorMsg] = useState(\"\");\n  const [registerSuccess, setRegisterSuccess] = useState(false);\n  const appLink = `https://benzen-server.herokuapp.com`; //location\n\n  const location = useLocation();\n  const dispatch = useDispatch();\n  const pathName = location.pathname.split(\"/\")[3];\n  const order = location.pathname.split(\"/\")[4]; //history\n\n  const history = useHistory();\n  useEffect(() => {\n    dispatch(loginAction(localStorage.getItem(\"userId\")));\n  }, [dispatch]); //getting width\n\n  useLayoutEffect(() => {\n    function updateSize() {\n      setSize([window.innerWidth, window.innerHeight]);\n    }\n\n    window.addEventListener(\"resize\", updateSize);\n    updateSize();\n    return () => window.removeEventListener(\"resize\", updateSize);\n  }, []);\n  useEffect(() => {\n    setMV(window.matchMedia(\"(min-width: 1000px)\").matches);\n  }, [size]); //handlers\n  //function sends request to database and tries to find email that user has given,\n  //if it finds it then we try to match password related to that email with encrypted password input\n  //if it all matches we set a local storage id and dispatch login\n\n  const loginHandler = e => {\n    e.preventDefault();\n    axios.get(loginUrl(loginEmailInput)).then(res => {\n      if (res.data[0]) {\n        if (res.data[0].password === sha512(loginPasswordInput).toString(Base64)) {\n          axios.put(`${appLink}/users/${res.data[0].id}/`, {\n            name: res.data[0].name,\n            surname: res.data[0].surname,\n            email: res.data[0].email,\n            password: res.data[0].password,\n            favorites: res.data[0].favorites,\n            addresses: res.data[0].addresses,\n            accessibility: res.data[0].accessibility\n          }).then(resp => {\n            localStorage.setItem(\"userId\", res.data[0].id);\n            dispatch(loginAction(localStorage.getItem(\"userId\")));\n            history.push(order ? \"/checkout/order\" : \"/customer/account/orders\");\n          }).catch(error => {});\n        } else {\n          setLoginErrorMsg(\"incorrect password\");\n          setFalseLogin(true);\n          setFalseEmail(false);\n        }\n      } else {\n        setFalseEmail(true);\n        setFalseLogin(false);\n        setLoginErrorMsg(\"Theres no account with this email\");\n      }\n    });\n  }; //this function tests email input with regex so its a legit email\n  //then it checks if password length is greater than 4\n  //and then checks if name and surname aren't empty\n  //if all of above is true it registers a user in  data base\n\n\n  const registerHandler = e => {\n    e.preventDefault();\n    axios.get(registerUrl(registerEmailInput)).then(res => {\n      if (res.data[0]) {\n        setRegisterSuccess(false);\n        setRegisterError(true);\n        setRegisterErrorMsg(\"Theres already an account with that email\");\n      } else {\n        if (/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/.test(registerEmailInput)) {\n          if (registerPassword.length >= 4) {\n            if (registerName !== \"\" && registerSurname !== \"\") {\n              axios.post(`${appLink}/users`, {\n                name: registerName,\n                surname: registerSurname,\n                email: registerEmailInput,\n                password: sha512(registerPassword).toString(Base64),\n                accessibility: \"customer\",\n                favorites: [],\n                addresses: []\n              }).then(resp => {\n                setRegisterSuccess(true);\n                setRegisterError(false);\n                setRegisterEmail(\"\");\n                setRegisterName(\"\");\n                setRegisterSurname(\"\");\n                setRegisterPassword(\"\");\n                setRegisterEmail(\"\");\n                dispatch(loginAction());\n              }).catch(error => {});\n            } else {\n              setRegisterSuccess(false);\n              setRegisterError(true);\n              setRegisterErrorMsg(\"Inputs cant be empty\");\n            }\n          } else {\n            setRegisterSuccess(false);\n            setRegisterError(true);\n            setRegisterErrorMsg(\"Password has to be at least 4 letters long\");\n          }\n        } else {\n          setRegisterSuccess(false);\n          setRegisterError(true);\n          setRegisterErrorMsg(\"incorrect email\");\n        }\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(AccountPageComponent, {\n    style: {\n      flexDirection: mv ? \"row\" : \"column\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"left-side\",\n      style: {\n        flex: pathName === \"login\" ? \"1.2\" : \"1\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Are you a user?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          color: \"rgba(245, 66, 66,0.7)\",\n          display: pathName === \"login\" && falseLogin || pathName === \"login\" && falseEmail ? \"block\" : \"none\"\n        },\n        children: loginErrorMsg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"login\",\n          style: {\n            display: pathName === \"login\" ? \"flex\" : \"none\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"email\",\n            children: /*#__PURE__*/_jsxDEV(TextField, {\n              label: \"Email\",\n              type: \"email\",\n              required: true,\n              value: loginEmailInput,\n              error: falseEmail ? true : false,\n              className: \"input\",\n              onChange: e => setLoginEmail(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"password\",\n            children: /*#__PURE__*/_jsxDEV(TextField, {\n              className: \"input\",\n              label: \"Password\",\n              required: true,\n              value: loginPasswordInput,\n              error: falseLogin ? true : false,\n              type: loginPasswordView ? \"password\" : \"\",\n              onChange: e => setLoginPassword(e.target.value),\n              InputProps: {\n                endAdornment: /*#__PURE__*/_jsxDEV(InputAdornment, {\n                  position: \"end\",\n                  children: /*#__PURE__*/_jsxDEV(VisibilityIcon, {\n                    onClick: () => setLoginPasswordView(!loginPasswordView)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 219,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 218,\n                  columnNumber: 21\n                }, this)\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/customer/account/login\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            onClick: e => pathName === \"login\" ? loginHandler(e) : \"\",\n            children: \"Sign in\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, this), order && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"anonymous-order\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/checkout/order\",\n              className: \"link\",\n              children: \"I want to purchase without logging in\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"right-side\",\n      style: {\n        flex: pathName === \"register\" ? \"1.2\" : \"1\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"register\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Is this your first visit?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            display: registerError ? \"block\" : \"none\",\n            color: \"red\"\n          },\n          children: registerErrorMsg\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            display: registerSuccess ? \"block\" : \"none\",\n            color: \"green\"\n          },\n          children: \"Registration was successful\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"register-form\",\n            style: {\n              display: pathName === \"register\" ? \"flex\" : \"none\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"email\",\n              children: /*#__PURE__*/_jsxDEV(TextField, {\n                label: \"Email\",\n                type: \"email\",\n                required: true,\n                value: registerEmailInput,\n                className: \"input\",\n                onChange: e => setRegisterEmail(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 276,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"name\",\n              children: [/*#__PURE__*/_jsxDEV(TextField, {\n                className: \"input name-input\",\n                label: \"Name\",\n                required: true,\n                value: registerName,\n                onChange: e => setRegisterName(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 286,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TextField, {\n                className: \"input name-input\",\n                label: \"Surname\",\n                required: true,\n                value: registerSurname,\n                onChange: e => setRegisterSurname(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"password\",\n              children: /*#__PURE__*/_jsxDEV(TextField, {\n                className: \"input\",\n                label: \"Password\",\n                required: true,\n                value: registerPassword,\n                type: registerPasswordView ? \"password\" : \"\",\n                onChange: e => setRegisterPassword(e.target.value),\n                InputProps: {\n                  endAdornment: /*#__PURE__*/_jsxDEV(InputAdornment, {\n                    position: \"end\",\n                    children: /*#__PURE__*/_jsxDEV(VisibilityIcon, {\n                      onClick: () => setRegisterPasswordView(!registerPasswordView)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 312,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 311,\n                    columnNumber: 23\n                  }, this)\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 302,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/customer/account/register\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              onClick: e => pathName === \"register\" ? registerHandler(e) : \"\",\n              children: \"Create account\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"you'll gain\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-gains\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [/*#__PURE__*/_jsxDEV(FavoriteIcon, {\n              className: \"icons\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 339,\n              columnNumber: 15\n            }, this), \"Favorite clothes\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [/*#__PURE__*/_jsxDEV(SearchIcon, {\n              className: \"icons\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 15\n            }, this), \"Convenient way to track your order\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [/*#__PURE__*/_jsxDEV(HistoryIcon, {\n              className: \"icons\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 347,\n              columnNumber: 15\n            }, this), \"Easy access to order history\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 169,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AccountPage, \"Y2oB5cVBoYr/YEFckfd3L9mAQTc=\", false, function () {\n  return [useLocation, useDispatch, useHistory];\n});\n\n_c = AccountPage;\nconst AccountPageComponent = styled.div`\n  display: flex;\n  min-height: 70vh;\n  justify-content: center;\n  align-items: center;\n  .left-side {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    text-align: center;\n    transform: 0.3s ease-in all;\n    padding: 1rem 0rem;\n    .login {\n      flex-direction: column;\n    }\n    h2 {\n      font-weight: bold;\n      font-size: 1.5rem;\n    }\n    .input {\n      width: 20rem;\n      padding: 1rem 0rem;\n    }\n    button {\n      border: 1px solid black;\n      padding: 0.5rem;\n      width: 20rem;\n      margin: 1rem 0rem;\n      background-color: black;\n      font-weight: bold;\n      color: white;\n      &:hover {\n        background-color: rgba(0, 0, 0, 0.8);\n      }\n    }\n    p {\n      font-size: 1rem;\n      font-weight: bold;\n      text-decoration: underline;\n    }\n  }\n  .right-side {\n    background-color: #f3f3f5;\n    height: 70vh;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    text-align: center;\n    transform: 0.3s ease-in all;\n    h2 {\n      padding: 2rem 0rem;\n      font-weight: bold;\n      font-size: 1.5rem;\n    }\n    button {\n      border: 1px solid black;\n      padding: 0.5rem;\n      width: 20rem;\n      margin: 1rem 0rem;\n      background-color: transparent;\n      font-weight: bold;\n      color: black;\n      &:hover {\n        background-color: black;\n        color: white;\n      }\n    }\n    .info {\n      text-align: left;\n      padding: 1rem 2rem;\n      font-size: 0.9rem;\n      text-transform: upperCase;\n    }\n    .info-gains {\n      text-align: left;\n      padding: 1rem;\n      h3 {\n        font-size: 1rem;\n        padding: 0.8rem 0rem;\n      }\n\n      .icons {\n        color: rgba(0, 0, 0, 0.6);\n        margin: 0rem 1rem;\n      }\n    }\n  }\n  .register {\n    .register-form {\n      flex-direction: column;\n    }\n    .email,\n    .password {\n      .input {\n        width: 42vh;\n      }\n    }\n    .name {\n      display: flex;\n      .name-input {\n        flex: 1;\n        margin-right: 1rem;\n      }\n    }\n  }\n`;\n_c2 = AccountPageComponent;\nexport default AccountPage;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"AccountPage\");\n$RefreshReg$(_c2, \"AccountPageComponent\");","map":{"version":3,"sources":["C:/Users/lukas/Desktop/Programowanko/Projekty/benzen/src/pages/LoginPage.js"],"names":["React","useState","useLayoutEffect","useEffect","useLocation","Link","useHistory","loginUrl","registerUrl","useDispatch","loginAction","styled","TextField","InputAdornment","VisibilityIcon","SearchIcon","FavoriteIcon","HistoryIcon","axios","sha512","Base64","AccountPage","size","setSize","mv","setMV","loginPasswordView","setLoginPasswordView","loginEmailInput","setLoginEmail","loginPasswordInput","setLoginPassword","falseLogin","setFalseLogin","falseEmail","setFalseEmail","loginErrorMsg","setLoginErrorMsg","registerPasswordView","setRegisterPasswordView","registerPassword","setRegisterPassword","registerEmailInput","setRegisterEmail","registerName","setRegisterName","registerSurname","setRegisterSurname","registerError","setRegisterError","registerErrorMsg","setRegisterErrorMsg","registerSuccess","setRegisterSuccess","appLink","location","dispatch","pathName","pathname","split","order","history","localStorage","getItem","updateSize","window","innerWidth","innerHeight","addEventListener","removeEventListener","matchMedia","matches","loginHandler","e","preventDefault","get","then","res","data","password","toString","put","id","name","surname","email","favorites","addresses","accessibility","resp","setItem","push","catch","error","registerHandler","test","length","post","flexDirection","flex","color","display","target","value","endAdornment","AccountPageComponent","div"],"mappings":"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oF,oBAAoB,GAAG9F,MAAM,CAAC+F,GAAI;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CA3GA;MAAMD,oB;AA4GN,eAAepF,WAAf","sourcesContent":["import React, { useState, useLayoutEffect, useEffect } from \"react\";\r\n//react router\r\nimport { useLocation } from \"react-router\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\n//api\r\nimport { loginUrl, registerUrl } from \"../api\";\r\n//redux\r\nimport { useDispatch } from \"react-redux\";\r\nimport { loginAction } from \"../actions/loginAction\";\r\n//styling\r\nimport styled from \"styled-components\";\r\n//material ui\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\n//icons\r\nimport VisibilityIcon from \"@material-ui/icons/Visibility\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\r\n//history\r\nimport HistoryIcon from \"@material-ui/icons/History\";\r\nimport axios from \"axios\";\r\n//encrypting password\r\nimport sha512 from \"crypto-js/sha512\";\r\nimport Base64 from \"crypto-js/enc-base64\";\r\n\r\nconst AccountPage = () => {\r\n  //state\r\n  const [size, setSize] = useState([0, 0]);\r\n  const [mv, setMV] = useState(false);\r\n  //login state\r\n  const [loginPasswordView, setLoginPasswordView] = useState(true);\r\n  const [loginEmailInput, setLoginEmail] = useState(\"\");\r\n  const [loginPasswordInput, setLoginPassword] = useState(\"\");\r\n  const [falseLogin, setFalseLogin] = useState(false);\r\n  const [falseEmail, setFalseEmail] = useState(false);\r\n  const [loginErrorMsg, setLoginErrorMsg] = useState(false);\r\n  //register state\r\n  const [registerPasswordView, setRegisterPasswordView] = useState(true);\r\n  const [registerPassword, setRegisterPassword] = useState(\"\");\r\n  const [registerEmailInput, setRegisterEmail] = useState(\"\");\r\n  const [registerName, setRegisterName] = useState(\"\");\r\n  const [registerSurname, setRegisterSurname] = useState(\"\");\r\n  const [registerError, setRegisterError] = useState(false);\r\n  const [registerErrorMsg, setRegisterErrorMsg] = useState(\"\");\r\n  const [registerSuccess, setRegisterSuccess] = useState(false);\r\n  const appLink = `https://benzen-server.herokuapp.com`;\r\n  //location\r\n  const location = useLocation();\r\n  const dispatch = useDispatch();\r\n  const pathName = location.pathname.split(\"/\")[3];\r\n  const order = location.pathname.split(\"/\")[4];\r\n  //history\r\n  const history = useHistory();\r\n  useEffect(() => {\r\n    dispatch(loginAction(localStorage.getItem(\"userId\")));\r\n  }, [dispatch]);\r\n  //getting width\r\n  useLayoutEffect(() => {\r\n    function updateSize() {\r\n      setSize([window.innerWidth, window.innerHeight]);\r\n    }\r\n    window.addEventListener(\"resize\", updateSize);\r\n    updateSize();\r\n    return () => window.removeEventListener(\"resize\", updateSize);\r\n  }, []);\r\n  useEffect(() => {\r\n    setMV(window.matchMedia(\"(min-width: 1000px)\").matches);\r\n  }, [size]);\r\n  //handlers\r\n  //function sends request to database and tries to find email that user has given,\r\n  //if it finds it then we try to match password related to that email with encrypted password input\r\n  //if it all matches we set a local storage id and dispatch login\r\n  const loginHandler = (e) => {\r\n    e.preventDefault();\r\n    axios.get(loginUrl(loginEmailInput)).then((res) => {\r\n      if (res.data[0]) {\r\n        if (\r\n          res.data[0].password === sha512(loginPasswordInput).toString(Base64)\r\n        ) {\r\n          axios\r\n            .put(`${appLink}/users/${res.data[0].id}/`, {\r\n              name: res.data[0].name,\r\n              surname: res.data[0].surname,\r\n              email: res.data[0].email,\r\n              password: res.data[0].password,\r\n              favorites: res.data[0].favorites,\r\n              addresses: res.data[0].addresses,\r\n              accessibility: res.data[0].accessibility,\r\n            })\r\n            .then((resp) => {\r\n              localStorage.setItem(\"userId\", res.data[0].id);\r\n              dispatch(loginAction(localStorage.getItem(\"userId\")));\r\n              history.push(\r\n                order ? \"/checkout/order\" : \"/customer/account/orders\"\r\n              );\r\n            })\r\n            .catch((error) => {});\r\n        } else {\r\n          setLoginErrorMsg(\"incorrect password\");\r\n          setFalseLogin(true);\r\n          setFalseEmail(false);\r\n        }\r\n      } else {\r\n        setFalseEmail(true);\r\n        setFalseLogin(false);\r\n        setLoginErrorMsg(\"Theres no account with this email\");\r\n      }\r\n    });\r\n  };\r\n  //this function tests email input with regex so its a legit email\r\n  //then it checks if password length is greater than 4\r\n  //and then checks if name and surname aren't empty\r\n  //if all of above is true it registers a user in  data base\r\n  const registerHandler = (e) => {\r\n    e.preventDefault();\r\n    axios.get(registerUrl(registerEmailInput)).then((res) => {\r\n      if (res.data[0]) {\r\n        setRegisterSuccess(false);\r\n        setRegisterError(true);\r\n        setRegisterErrorMsg(\"Theres already an account with that email\");\r\n      } else {\r\n        if (\r\n          /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/.test(\r\n            registerEmailInput\r\n          )\r\n        ) {\r\n          if (registerPassword.length >= 4) {\r\n            if (registerName !== \"\" && registerSurname !== \"\") {\r\n              axios\r\n                .post(`${appLink}/users`, {\r\n                  name: registerName,\r\n                  surname: registerSurname,\r\n                  email: registerEmailInput,\r\n                  password: sha512(registerPassword).toString(Base64),\r\n                  accessibility: \"customer\",\r\n                  favorites: [],\r\n                  addresses: [],\r\n                })\r\n                .then((resp) => {\r\n                  setRegisterSuccess(true);\r\n                  setRegisterError(false);\r\n                  setRegisterEmail(\"\");\r\n                  setRegisterName(\"\");\r\n                  setRegisterSurname(\"\");\r\n                  setRegisterPassword(\"\");\r\n                  setRegisterEmail(\"\");\r\n                  dispatch(loginAction());\r\n                })\r\n                .catch((error) => {});\r\n            } else {\r\n              setRegisterSuccess(false);\r\n              setRegisterError(true);\r\n              setRegisterErrorMsg(\"Inputs cant be empty\");\r\n            }\r\n          } else {\r\n            setRegisterSuccess(false);\r\n            setRegisterError(true);\r\n            setRegisterErrorMsg(\"Password has to be at least 4 letters long\");\r\n          }\r\n        } else {\r\n          setRegisterSuccess(false);\r\n          setRegisterError(true);\r\n          setRegisterErrorMsg(\"incorrect email\");\r\n        }\r\n      }\r\n    });\r\n  };\r\n  return (\r\n    <AccountPageComponent\r\n      style={{\r\n        flexDirection: mv ? \"row\" : \"column\",\r\n      }}\r\n    >\r\n      <div\r\n        className=\"left-side\"\r\n        style={{ flex: pathName === \"login\" ? \"1.2\" : \"1\" }}\r\n      >\r\n        <h2>Are you a user?</h2>\r\n        <span\r\n          style={{\r\n            color: \"rgba(245, 66, 66,0.7)\",\r\n            display:\r\n              (pathName === \"login\" && falseLogin) ||\r\n              (pathName === \"login\" && falseEmail)\r\n                ? \"block\"\r\n                : \"none\",\r\n          }}\r\n        >\r\n          {loginErrorMsg}\r\n        </span>\r\n        <form>\r\n          <div\r\n            className=\"login\"\r\n            style={{ display: pathName === \"login\" ? \"flex\" : \"none\" }}\r\n          >\r\n            <div className=\"email\">\r\n              <TextField\r\n                label=\"Email\"\r\n                type=\"email\"\r\n                required\r\n                value={loginEmailInput}\r\n                error={falseEmail ? true : false}\r\n                className=\"input\"\r\n                onChange={(e) => setLoginEmail(e.target.value)}\r\n              />\r\n            </div>\r\n            <div className=\"password\">\r\n              <TextField\r\n                className=\"input\"\r\n                label=\"Password\"\r\n                required\r\n                value={loginPasswordInput}\r\n                error={falseLogin ? true : false}\r\n                type={loginPasswordView ? \"password\" : \"\"}\r\n                onChange={(e) => setLoginPassword(e.target.value)}\r\n                InputProps={{\r\n                  endAdornment: (\r\n                    <InputAdornment position=\"end\">\r\n                      <VisibilityIcon\r\n                        onClick={() => setLoginPasswordView(!loginPasswordView)}\r\n                      />\r\n                    </InputAdornment>\r\n                  ),\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <Link to=\"/customer/account/login\">\r\n            <button\r\n              type=\"submit\"\r\n              onClick={(e) => (pathName === \"login\" ? loginHandler(e) : \"\")}\r\n            >\r\n              Sign in\r\n            </button>\r\n          </Link>\r\n          {order && (\r\n            <div className=\"anonymous-order\">\r\n              <span>\r\n                <Link to=\"/checkout/order\" className=\"link\">\r\n                  I want to purchase without logging in\r\n                </Link>\r\n              </span>\r\n            </div>\r\n          )}\r\n        </form>\r\n      </div>\r\n      <div\r\n        className=\"right-side\"\r\n        style={{ flex: pathName === \"register\" ? \"1.2\" : \"1\" }}\r\n      >\r\n        <div className=\"register\">\r\n          <h2>Is this your first visit?</h2>\r\n          <span\r\n            style={{\r\n              display: registerError ? \"block\" : \"none\",\r\n              color: \"red\",\r\n            }}\r\n          >\r\n            {registerErrorMsg}\r\n          </span>\r\n          <span\r\n            style={{\r\n              display: registerSuccess ? \"block\" : \"none\",\r\n              color: \"green\",\r\n            }}\r\n          >\r\n            Registration was successful\r\n          </span>\r\n          <form>\r\n            <div\r\n              className=\"register-form\"\r\n              style={{ display: pathName === \"register\" ? \"flex\" : \"none\" }}\r\n            >\r\n              <div className=\"email\">\r\n                <TextField\r\n                  label=\"Email\"\r\n                  type=\"email\"\r\n                  required\r\n                  value={registerEmailInput}\r\n                  className=\"input\"\r\n                  onChange={(e) => setRegisterEmail(e.target.value)}\r\n                />\r\n              </div>\r\n              <div className=\"name\">\r\n                <TextField\r\n                  className=\"input name-input\"\r\n                  label=\"Name\"\r\n                  required\r\n                  value={registerName}\r\n                  onChange={(e) => setRegisterName(e.target.value)}\r\n                />\r\n                <TextField\r\n                  className=\"input name-input\"\r\n                  label=\"Surname\"\r\n                  required\r\n                  value={registerSurname}\r\n                  onChange={(e) => setRegisterSurname(e.target.value)}\r\n                />\r\n              </div>\r\n              <div className=\"password\">\r\n                <TextField\r\n                  className=\"input\"\r\n                  label=\"Password\"\r\n                  required\r\n                  value={registerPassword}\r\n                  type={registerPasswordView ? \"password\" : \"\"}\r\n                  onChange={(e) => setRegisterPassword(e.target.value)}\r\n                  InputProps={{\r\n                    endAdornment: (\r\n                      <InputAdornment position=\"end\">\r\n                        <VisibilityIcon\r\n                          onClick={() =>\r\n                            setRegisterPasswordView(!registerPasswordView)\r\n                          }\r\n                        />\r\n                      </InputAdornment>\r\n                    ),\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n            <Link to=\"/customer/account/register\">\r\n              <button\r\n                type=\"submit\"\r\n                onClick={(e) =>\r\n                  pathName === \"register\" ? registerHandler(e) : \"\"\r\n                }\r\n              >\r\n                Create account\r\n              </button>\r\n            </Link>\r\n          </form>\r\n          <div className=\"info\">\r\n            <span>you'll gain</span>\r\n          </div>\r\n          <div className=\"info-gains\">\r\n            <h3>\r\n              <FavoriteIcon className=\"icons\" />\r\n              Favorite clothes\r\n            </h3>\r\n            <h3>\r\n              <SearchIcon className=\"icons\" />\r\n              Convenient way to track your order\r\n            </h3>\r\n            <h3>\r\n              <HistoryIcon className=\"icons\" />\r\n              Easy access to order history\r\n            </h3>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </AccountPageComponent>\r\n  );\r\n};\r\n\r\nconst AccountPageComponent = styled.div`\r\n  display: flex;\r\n  min-height: 70vh;\r\n  justify-content: center;\r\n  align-items: center;\r\n  .left-side {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    text-align: center;\r\n    transform: 0.3s ease-in all;\r\n    padding: 1rem 0rem;\r\n    .login {\r\n      flex-direction: column;\r\n    }\r\n    h2 {\r\n      font-weight: bold;\r\n      font-size: 1.5rem;\r\n    }\r\n    .input {\r\n      width: 20rem;\r\n      padding: 1rem 0rem;\r\n    }\r\n    button {\r\n      border: 1px solid black;\r\n      padding: 0.5rem;\r\n      width: 20rem;\r\n      margin: 1rem 0rem;\r\n      background-color: black;\r\n      font-weight: bold;\r\n      color: white;\r\n      &:hover {\r\n        background-color: rgba(0, 0, 0, 0.8);\r\n      }\r\n    }\r\n    p {\r\n      font-size: 1rem;\r\n      font-weight: bold;\r\n      text-decoration: underline;\r\n    }\r\n  }\r\n  .right-side {\r\n    background-color: #f3f3f5;\r\n    height: 70vh;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    text-align: center;\r\n    transform: 0.3s ease-in all;\r\n    h2 {\r\n      padding: 2rem 0rem;\r\n      font-weight: bold;\r\n      font-size: 1.5rem;\r\n    }\r\n    button {\r\n      border: 1px solid black;\r\n      padding: 0.5rem;\r\n      width: 20rem;\r\n      margin: 1rem 0rem;\r\n      background-color: transparent;\r\n      font-weight: bold;\r\n      color: black;\r\n      &:hover {\r\n        background-color: black;\r\n        color: white;\r\n      }\r\n    }\r\n    .info {\r\n      text-align: left;\r\n      padding: 1rem 2rem;\r\n      font-size: 0.9rem;\r\n      text-transform: upperCase;\r\n    }\r\n    .info-gains {\r\n      text-align: left;\r\n      padding: 1rem;\r\n      h3 {\r\n        font-size: 1rem;\r\n        padding: 0.8rem 0rem;\r\n      }\r\n\r\n      .icons {\r\n        color: rgba(0, 0, 0, 0.6);\r\n        margin: 0rem 1rem;\r\n      }\r\n    }\r\n  }\r\n  .register {\r\n    .register-form {\r\n      flex-direction: column;\r\n    }\r\n    .email,\r\n    .password {\r\n      .input {\r\n        width: 42vh;\r\n      }\r\n    }\r\n    .name {\r\n      display: flex;\r\n      .name-input {\r\n        flex: 1;\r\n        margin-right: 1rem;\r\n      }\r\n    }\r\n  }\r\n`;\r\nexport default AccountPage;\r\n"]},"metadata":{},"sourceType":"module"}