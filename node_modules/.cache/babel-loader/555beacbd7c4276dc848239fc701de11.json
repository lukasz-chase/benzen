{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\lukas\\\\Desktop\\\\Programowanko\\\\Projekty\\\\benzen\\\\client\\\\src\\\\pages\\\\CartPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\"; //styling\n\nimport styled from \"styled-components\"; //router\n\nimport { Link } from \"react-router-dom\"; //actions\n\nimport { getUserOrders } from \"../actions/ordersAction\"; //redux\n\nimport { useDispatch, useSelector } from \"react-redux\"; //material ui\n\nimport Accordion from \"@material-ui/core/Accordion\";\nimport AccordionSummary from \"@material-ui/core/AccordionSummary\";\nimport AccordionDetails from \"@material-ui/core/AccordionDetails\";\nimport TextField from \"@material-ui/core/TextField\"; //icons\n\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport CloseIcon from \"@material-ui/icons/Close\"; //components\n\nimport Button from \"../components/Button\";\nimport CartItem from \"../components/CartItem\"; //notistack\n\nimport { useSnackbar } from \"notistack\"; //constants\n\nimport { DISCOUNT_CART_PRICE, SET_CART_PRICE, CHANGE_ITEM_PRICE } from \"../constants/actionTypes\";\n\nconst CartPage = () => {\n  _s();\n\n  //snack bar\n  const {\n    enqueueSnackbar,\n    closeSnackbar\n  } = useSnackbar();\n  const [discountInput, setDiscountInput] = useState(\"\");\n  const [discountBanner, setDiscountBanner] = useState(true);\n  const [PriceBeforeDiscounts, setPriceBeforeDiscounts] = useState(0);\n  const dispatch = useDispatch();\n  const {\n    cart,\n    cartPrice,\n    discount\n  } = useSelector(state => state.cart);\n  const {\n    user\n  } = useSelector(state => state.user);\n  useEffect(() => {\n    if (user) {\n      dispatch(getUserOrders(user._id));\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [user]);\n  const {\n    userOrders\n  } = useSelector(state => state.orders);\n  useEffect(() => {\n    if (cart) {\n      if (cart.length === 1) {\n        dispatch({\n          type: SET_CART_PRICE,\n          payload: {\n            price: cart[0].price * cart[0].cartAmount\n          }\n        });\n      } else if (cart.length > 1) {\n        dispatch({\n          type: SET_CART_PRICE,\n          payload: {\n            price: cart.reduce(function (a, s) {\n              return a += s.price * s.cartAmount;\n            }, 0)\n          }\n        });\n      }\n    }\n  }, [cart, discount, dispatch]);\n  useEffect(() => {\n    setPriceBeforeDiscounts(cart.reduce(function (a, b) {\n      return b.discount ? a += b.priceBeforeDiscount * b.cartAmount : a += b.price * b.cartAmount;\n    }, false));\n  }, [cart]);\n  useEffect(() => {\n    if (discount) {\n      cart.forEach(item => !item.discount ? dispatch({\n        type: CHANGE_ITEM_PRICE,\n        payload: {\n          id: item._id,\n          size: item.size\n        }\n      }) : \"\");\n    }\n  }, [cart, discount, dispatch]); //handlers\n\n  const snackbarHandler = (snackbarMessage, snackVariant) => {\n    enqueueSnackbar(snackbarMessage, {\n      variant: snackVariant\n    });\n    closeSnackbar(500);\n  };\n\n  const discountHandler = () => {\n    if (!discount) {\n      if (discountInput === \"DISCOUNT10\" || discountInput === \"discount10\") {\n        if (user) {\n          if (userOrders.length === 0) {\n            cart.forEach(item => !item.discount ? dispatch({\n              type: CHANGE_ITEM_PRICE,\n              payload: {\n                id: item._id\n              }\n            }) : \"\");\n            dispatch({\n              type: DISCOUNT_CART_PRICE,\n              payload: {\n                boolean: true\n              }\n            });\n          } else {\n            snackbarHandler(\"this coupon code was only for first order\", \"success\");\n          }\n        } else {\n          snackbarHandler(\"this coupon code works only for logged users\", \"success\");\n        }\n      } else {\n        snackbarHandler(`coupon code ${discountInput} is not valid`, \"success\");\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(CartPageComponent, {\n    children: cart.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"empty-cart\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Your cart is empty\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"continue shopping\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"buttons\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/woman\",\n          className: \"link\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            label: \"Women\",\n            size: \"lg\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/man\",\n          className: \"link\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            label: \"Men\",\n            size: \"lg\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: cart && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cart-with-items\",\n        children: [user && discountBanner && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"discount-banner\",\n          style: {\n            display: userOrders.length === 0 ? \"flex\" : \"none\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"enter a discount code \\\"DISCOUNT10\\\" and get 10% off your first order\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"doesn't work with other discounts\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(CloseIcon, {\n            className: \"close-banner-icon\",\n            onClick: () => setDiscountBanner(!discountBanner)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart-view\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"itemsDisplay\",\n            children: cart.map((item, index) => /*#__PURE__*/_jsxDEV(CartItem, {\n              item: item\n            }, item._id + index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"full-price\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"products price:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 175,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"price\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  style: {\n                    color: discount ? \"red\" : \"black\"\n                  },\n                  children: [cartPrice, \" GBP\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 177,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  style: {\n                    display: cart.find(i => i.discount === true || i.discount === \"true\") ? \"block\" : \"none\",\n                    textDecoration: \"line-through\"\n                  },\n                  children: [PriceBeforeDiscounts.toFixed(2), \"GBP\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 180,\n                  columnNumber: 23\n                }, this), \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 176,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"checkout-button\",\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                to: user._id ? \"/checkout/order\" : \"/customer/account/login/order\",\n                className: \"link\",\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  label: \"Go to checkout\",\n                  variant: \"black\",\n                  size: \"lg\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 203,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 195,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"coupon\",\n              children: /*#__PURE__*/_jsxDEV(Accordion, {\n                className: \"accordion\",\n                children: [/*#__PURE__*/_jsxDEV(AccordionSummary, {\n                  expandIcon: /*#__PURE__*/_jsxDEV(ExpandMoreIcon, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 213,\n                    columnNumber: 37\n                  }, this),\n                  className: \"accordion-header\",\n                  children: \"i have a coupon code\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(AccordionDetails, {\n                  className: \"accordion-details\",\n                  children: [/*#__PURE__*/_jsxDEV(TextField, {\n                    className: \"input\",\n                    value: discountInput,\n                    onChange: e => setDiscountInput(e.target.value),\n                    onKeyDown: e => e.key === \"Enter\" ? discountHandler() : \"\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 219,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    label: \"Add\",\n                    onClick: () => discountHandler()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 227,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 218,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 13\n      }, this)\n    }, void 0, false)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CartPage, \"Zx9TQXY9YRHT7ME/IJtFmC6XJ/4=\", false, function () {\n  return [useSnackbar, useDispatch, useSelector, useSelector, useSelector];\n});\n\n_c = CartPage;\nconst CartPageComponent = styled.div`\n  min-height: 50vh;\n  font-size: 1.5rem;\n  .empty-cart {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    margin-top: 2rem;\n  }\n  .cart-with-items {\n    display: flex;\n    flex-direction: column;\n    .discount-banner {\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      text-align: center;\n      background-color: rgba(0, 0, 0, 0.2);\n      color: white;\n\n      span {\n        font-size: 1rem;\n        @media screen and (max-width: 1000px) {\n          font-size: 0.6rem;\n        }\n      }\n      p {\n        font-size: 0.6rem;\n        @media screen and (max-width: 1000px) {\n          font-size: 0.4rem;\n        }\n      }\n      .close-banner-icon {\n        position: absolute;\n        right: 0;\n        top: 0;\n        margin: 0.5rem;\n        color: white;\n        transition: 0.3s ease-in all;\n        @media screen and (max-width: 1000px) {\n          font-size: 1rem;\n        }\n        &:hover {\n          cursor: pointer;\n          color: tomato;\n        }\n      }\n    }\n    .cart-view {\n      display: flex;\n      min-height: 50vh;\n      @media screen and (max-width: 1000px) {\n        flex-direction: column;\n      }\n      .itemsDisplay {\n        width: 70%;\n        display: flex;\n        align-items: flex-end;\n        flex-direction: column;\n        margin: 0rem 1rem;\n        @media screen and (max-width: 1000px) {\n          width: 100%;\n        }\n      }\n      .cart-info {\n        width: 30%;\n        background-color: #f3f3f5;\n        display: flex;\n        justify-content: center;\n        flex-direction: column;\n        align-items: center;\n        @media screen and (max-width: 1000px) {\n          width: 100%;\n        }\n        .full-price {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          flex-direction: column;\n          width: 70%;\n          font-size: 1.5rem;\n\n          @media screen and (max-width: 1000px) {\n            margin-top: 1rem;\n            font-size: 1rem;\n            width: 100%;\n          }\n          .price {\n            margin-top: 1rem;\n            display: flex;\n            width: 100%;\n            justify-content: space-evenly;\n            @media screen and (max-width: 1000px) {\n              margin-top: 0.5rem;\n            }\n          }\n        }\n        .checkout-button {\n          width: 70%;\n          @media screen and (max-width: 1000px) {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            font-size: 1rem;\n            width: 100%;\n          }\n        }\n        .coupon {\n          width: 70%;\n          @media screen and (max-width: 1000px) {\n            font-size: 1rem;\n            width: 100%;\n          }\n          .accordion {\n            width: 100%;\n            font-size: 1rem;\n            .accordion-details {\n              display: flex;\n              flex-direction: column;\n              align-items: center;\n              .input {\n                width: 100%;\n                margin-right: 15px;\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n`;\n_c2 = CartPageComponent;\nexport default CartPage;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CartPage\");\n$RefreshReg$(_c2, \"CartPageComponent\");","map":{"version":3,"sources":["C:/Users/lukas/Desktop/Programowanko/Projekty/benzen/client/src/pages/CartPage.js"],"names":["React","useState","useEffect","styled","Link","getUserOrders","useDispatch","useSelector","Accordion","AccordionSummary","AccordionDetails","TextField","ExpandMoreIcon","CloseIcon","Button","CartItem","useSnackbar","DISCOUNT_CART_PRICE","SET_CART_PRICE","CHANGE_ITEM_PRICE","CartPage","enqueueSnackbar","closeSnackbar","discountInput","setDiscountInput","discountBanner","setDiscountBanner","PriceBeforeDiscounts","setPriceBeforeDiscounts","dispatch","cart","cartPrice","discount","state","user","_id","userOrders","orders","length","type","payload","price","cartAmount","reduce","a","s","b","priceBeforeDiscount","forEach","item","id","size","snackbarHandler","snackbarMessage","snackVariant","variant","discountHandler","boolean","display","map","index","color","find","i","textDecoration","toFixed","e","target","value","key","CartPageComponent","div"],"mappings":"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A,wCACE,QAAC,gBAAD;AACE,kBAAA,UAAU,eAAE,QAAC,cAAD;AAAA;AAAA;AAAA;AAAA,0BADd;AAEE,kBAAA,SAAS,EAAC,kBAFZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAOE,QAAC,gBAAD;AAAkB,kBAAA,SAAS,EAAC,mBAA5B;AAAA,0CACE,QAAC,SAAD;AACE,oBAAA,SAAS,EAAC,OADZ;AAEE,oBAAA,KAAK,EAAEZ,aAFT;AAGE,oBAAA,QAAQ,EAAG2C,CAAD,IAAO1C,gBAAgB,CAAC0C,CAAC,CAACC,MAAF,CAASC,KAAV,CAHnC;AAIE,oBAAA,SAAS,EAAGF,CAAD,IACTA,CAAC,CAACG,GAAF,KAAU,OAAV,GAAoBb,eAAe,EAAnC,GAAwC;AAL5C;AAAA;AAAA;AAAA;AAAA,0BADF,eASE,QAAC,MAAD;AAAQ,oBAAA,KAAK,EAAC,KAAd;AAAoB,oBAAA,OAAO,EAAE,MAAMA,eAAe;AAAlD;AAAA;AAAA;AAAA;AAAA,0BATF;AAAA;AAAA;AAAA;AAAA;AAAA,wBAPF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBArCF;AAAA;AAAA;AAAA;AAAA;AAAA,kBANF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAnBF;AAAA;AAAA;AAAA;AAAA;AAAA;AAFJ;AAfJ;AAAA;AAAA;AAAA;AAAA,UADF;AA6GD,CAjND;;GAAMpC,Q;UAEuCJ,W,EAI1BV,W,EACqBC,W,EACrBA,W,EAOMA,W;;;KAfnBa,Q;AAmNN,MAAMkD,iBAAiB,GAAGnE,MAAM,CAACoE,GAAI;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CArIA;MAAMD,iB;AAuIN,eAAelD,QAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\n//styling\r\nimport styled from \"styled-components\";\r\n//router\r\nimport { Link } from \"react-router-dom\";\r\n//actions\r\nimport { getUserOrders } from \"../actions/ordersAction\";\r\n//redux\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n//material ui\r\nimport Accordion from \"@material-ui/core/Accordion\";\r\nimport AccordionSummary from \"@material-ui/core/AccordionSummary\";\r\nimport AccordionDetails from \"@material-ui/core/AccordionDetails\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\n//icons\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\n//components\r\nimport Button from \"../components/Button\";\r\nimport CartItem from \"../components/CartItem\";\r\n//notistack\r\nimport { useSnackbar } from \"notistack\";\r\n//constants\r\nimport {\r\n  DISCOUNT_CART_PRICE,\r\n  SET_CART_PRICE,\r\n  CHANGE_ITEM_PRICE,\r\n} from \"../constants/actionTypes\";\r\n\r\nconst CartPage = () => {\r\n  //snack bar\r\n  const { enqueueSnackbar, closeSnackbar } = useSnackbar();\r\n  const [discountInput, setDiscountInput] = useState(\"\");\r\n  const [discountBanner, setDiscountBanner] = useState(true);\r\n  const [PriceBeforeDiscounts, setPriceBeforeDiscounts] = useState(0);\r\n  const dispatch = useDispatch();\r\n  const { cart, cartPrice, discount } = useSelector((state) => state.cart);\r\n  const { user } = useSelector((state) => state.user);\r\n  useEffect(() => {\r\n    if (user) {\r\n      dispatch(getUserOrders(user._id));\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [user]);\r\n  const { userOrders } = useSelector((state) => state.orders);\r\n  useEffect(() => {\r\n    if (cart) {\r\n      if (cart.length === 1) {\r\n        dispatch({\r\n          type: SET_CART_PRICE,\r\n          payload: {\r\n            price: cart[0].price * cart[0].cartAmount,\r\n          },\r\n        });\r\n      } else if (cart.length > 1) {\r\n        dispatch({\r\n          type: SET_CART_PRICE,\r\n          payload: {\r\n            price: cart.reduce(function (a, s) {\r\n              return (a += s.price * s.cartAmount);\r\n            }, 0),\r\n          },\r\n        });\r\n      }\r\n    }\r\n  }, [cart, discount, dispatch]);\r\n  useEffect(() => {\r\n    setPriceBeforeDiscounts(\r\n      cart.reduce(function (a, b) {\r\n        return b.discount\r\n          ? (a += b.priceBeforeDiscount * b.cartAmount)\r\n          : (a += b.price * b.cartAmount);\r\n      }, false)\r\n    );\r\n  }, [cart]);\r\n  useEffect(() => {\r\n    if (discount) {\r\n      cart.forEach((item) =>\r\n        !item.discount\r\n          ? dispatch({\r\n              type: CHANGE_ITEM_PRICE,\r\n              payload: { id: item._id, size: item.size },\r\n            })\r\n          : \"\"\r\n      );\r\n    }\r\n  }, [cart, discount, dispatch]);\r\n  //handlers\r\n  const snackbarHandler = (snackbarMessage, snackVariant) => {\r\n    enqueueSnackbar(snackbarMessage, { variant: snackVariant });\r\n    closeSnackbar(500);\r\n  };\r\n\r\n  const discountHandler = () => {\r\n    if (!discount) {\r\n      if (discountInput === \"DISCOUNT10\" || discountInput === \"discount10\") {\r\n        if (user) {\r\n          if (userOrders.length === 0) {\r\n            cart.forEach((item) =>\r\n              !item.discount\r\n                ? dispatch({\r\n                    type: CHANGE_ITEM_PRICE,\r\n                    payload: { id: item._id },\r\n                  })\r\n                : \"\"\r\n            );\r\n            dispatch({\r\n              type: DISCOUNT_CART_PRICE,\r\n              payload: {\r\n                boolean: true,\r\n              },\r\n            });\r\n          } else {\r\n            snackbarHandler(\r\n              \"this coupon code was only for first order\",\r\n              \"success\"\r\n            );\r\n          }\r\n        } else {\r\n          snackbarHandler(\r\n            \"this coupon code works only for logged users\",\r\n            \"success\"\r\n          );\r\n        }\r\n      } else {\r\n        snackbarHandler(`coupon code ${discountInput} is not valid`, \"success\");\r\n      }\r\n    }\r\n  };\r\n  return (\r\n    <CartPageComponent>\r\n      {cart.length === 0 ? (\r\n        <div className=\"empty-cart\">\r\n          <h2>Your cart is empty</h2>\r\n          <p>continue shopping</p>\r\n          <div className=\"buttons\">\r\n            <Link to=\"/woman\" className=\"link\">\r\n              <Button label=\"Women\" size=\"lg\" />\r\n            </Link>\r\n            <Link to=\"/man\" className=\"link\">\r\n              <Button label=\"Men\" size=\"lg\" />\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {cart && (\r\n            <div className=\"cart-with-items\">\r\n              {user && discountBanner && (\r\n                <div\r\n                  className=\"discount-banner\"\r\n                  style={{\r\n                    display: userOrders.length === 0 ? \"flex\" : \"none\",\r\n                  }}\r\n                >\r\n                  <span>\r\n                    enter a discount code \"DISCOUNT10\" and get 10% off your\r\n                    first order\r\n                  </span>\r\n                  <p>doesn't work with other discounts</p>\r\n                  <CloseIcon\r\n                    className=\"close-banner-icon\"\r\n                    onClick={() => setDiscountBanner(!discountBanner)}\r\n                  />\r\n                </div>\r\n              )}\r\n              <div className=\"cart-view\">\r\n                <div className=\"itemsDisplay\">\r\n                  {cart.map((item, index) => (\r\n                    <CartItem key={item._id + index} item={item} />\r\n                  ))}\r\n                </div>\r\n                <div className=\"cart-info\">\r\n                  <div className=\"full-price\">\r\n                    <span>products price:</span>\r\n                    <div className=\"price\">\r\n                      <span style={{ color: discount ? \"red\" : \"black\" }}>\r\n                        {cartPrice} GBP\r\n                      </span>\r\n                      <span\r\n                        style={{\r\n                          display: cart.find(\r\n                            (i) => i.discount === true || i.discount === \"true\"\r\n                          )\r\n                            ? \"block\"\r\n                            : \"none\",\r\n                          textDecoration: \"line-through\",\r\n                        }}\r\n                      >\r\n                        {PriceBeforeDiscounts.toFixed(2)}GBP\r\n                      </span>{\" \"}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"checkout-button\">\r\n                    <Link\r\n                      to={\r\n                        user._id\r\n                          ? \"/checkout/order\"\r\n                          : \"/customer/account/login/order\"\r\n                      }\r\n                      className=\"link\"\r\n                    >\r\n                      <Button\r\n                        label=\"Go to checkout\"\r\n                        variant=\"black\"\r\n                        size=\"lg\"\r\n                      />\r\n                    </Link>\r\n                  </div>\r\n                  <div className=\"coupon\">\r\n                    <Accordion className=\"accordion\">\r\n                      <AccordionSummary\r\n                        expandIcon={<ExpandMoreIcon />}\r\n                        className=\"accordion-header\"\r\n                      >\r\n                        i have a coupon code\r\n                      </AccordionSummary>\r\n                      <AccordionDetails className=\"accordion-details\">\r\n                        <TextField\r\n                          className=\"input\"\r\n                          value={discountInput}\r\n                          onChange={(e) => setDiscountInput(e.target.value)}\r\n                          onKeyDown={(e) =>\r\n                            e.key === \"Enter\" ? discountHandler() : \"\"\r\n                          }\r\n                        />\r\n                        <Button label=\"Add\" onClick={() => discountHandler()} />\r\n                      </AccordionDetails>\r\n                    </Accordion>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </>\r\n      )}\r\n    </CartPageComponent>\r\n  );\r\n};\r\n\r\nconst CartPageComponent = styled.div`\r\n  min-height: 50vh;\r\n  font-size: 1.5rem;\r\n  .empty-cart {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    margin-top: 2rem;\r\n  }\r\n  .cart-with-items {\r\n    display: flex;\r\n    flex-direction: column;\r\n    .discount-banner {\r\n      position: relative;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      justify-content: center;\r\n      text-align: center;\r\n      background-color: rgba(0, 0, 0, 0.2);\r\n      color: white;\r\n\r\n      span {\r\n        font-size: 1rem;\r\n        @media screen and (max-width: 1000px) {\r\n          font-size: 0.6rem;\r\n        }\r\n      }\r\n      p {\r\n        font-size: 0.6rem;\r\n        @media screen and (max-width: 1000px) {\r\n          font-size: 0.4rem;\r\n        }\r\n      }\r\n      .close-banner-icon {\r\n        position: absolute;\r\n        right: 0;\r\n        top: 0;\r\n        margin: 0.5rem;\r\n        color: white;\r\n        transition: 0.3s ease-in all;\r\n        @media screen and (max-width: 1000px) {\r\n          font-size: 1rem;\r\n        }\r\n        &:hover {\r\n          cursor: pointer;\r\n          color: tomato;\r\n        }\r\n      }\r\n    }\r\n    .cart-view {\r\n      display: flex;\r\n      min-height: 50vh;\r\n      @media screen and (max-width: 1000px) {\r\n        flex-direction: column;\r\n      }\r\n      .itemsDisplay {\r\n        width: 70%;\r\n        display: flex;\r\n        align-items: flex-end;\r\n        flex-direction: column;\r\n        margin: 0rem 1rem;\r\n        @media screen and (max-width: 1000px) {\r\n          width: 100%;\r\n        }\r\n      }\r\n      .cart-info {\r\n        width: 30%;\r\n        background-color: #f3f3f5;\r\n        display: flex;\r\n        justify-content: center;\r\n        flex-direction: column;\r\n        align-items: center;\r\n        @media screen and (max-width: 1000px) {\r\n          width: 100%;\r\n        }\r\n        .full-price {\r\n          display: flex;\r\n          justify-content: space-between;\r\n          align-items: center;\r\n          flex-direction: column;\r\n          width: 70%;\r\n          font-size: 1.5rem;\r\n\r\n          @media screen and (max-width: 1000px) {\r\n            margin-top: 1rem;\r\n            font-size: 1rem;\r\n            width: 100%;\r\n          }\r\n          .price {\r\n            margin-top: 1rem;\r\n            display: flex;\r\n            width: 100%;\r\n            justify-content: space-evenly;\r\n            @media screen and (max-width: 1000px) {\r\n              margin-top: 0.5rem;\r\n            }\r\n          }\r\n        }\r\n        .checkout-button {\r\n          width: 70%;\r\n          @media screen and (max-width: 1000px) {\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            font-size: 1rem;\r\n            width: 100%;\r\n          }\r\n        }\r\n        .coupon {\r\n          width: 70%;\r\n          @media screen and (max-width: 1000px) {\r\n            font-size: 1rem;\r\n            width: 100%;\r\n          }\r\n          .accordion {\r\n            width: 100%;\r\n            font-size: 1rem;\r\n            .accordion-details {\r\n              display: flex;\r\n              flex-direction: column;\r\n              align-items: center;\r\n              .input {\r\n                width: 100%;\r\n                margin-right: 15px;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nexport default CartPage;\r\n"]},"metadata":{},"sourceType":"module"}